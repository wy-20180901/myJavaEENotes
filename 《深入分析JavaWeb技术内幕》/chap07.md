[toc]

# JVM体系结构与工作方式

- 以计算为中心，计算机体系结构可分为如下几个部分

  - 指令集
  - 计算单元
  - 寻址方式
  - 寄存器定义
  - 存储单元

- 主流的指令集有RISC（精简指令集）和CISC（复杂指令集）

- 指令集和可以直接被机器识别的机器码，也就是它必须以二进制格式存储在计算机中。

- JVM的特点

  - 一个抽象规范

    约束了JVM到底是什么（The Java Virtual Machine Specification）

  - 一个具体实现

    不同厂商按照规范结合软硬件在不同平台上的实现

  - 一个运行中的实例

    每个运行中的Java程序都是一个JVM实例

- JVM体系结构详解

  ![image-20210606095339107](https://raw.githubusercontent.com/KingdeGuo/myPictureBed/main/img_upload202106/06/095341-719752.png)

  - 类加载引擎
    - 在JVM启动时后者类运行时将需要的class加载到JVM中。
    - 每个被JVM装载的类型都有一个对应的`java.lang.Class`类的实例来表示该类型，该实例可以唯一表示被JVM装在的class类。这个实例和其他类的实例一样，是存放在堆中的。
  - 执行引擎
    - 负责执行class文件中的字节码指令。
    - 在《Java虚拟机规范》中详细定义了执行引擎遇到每条字节码指令时应该处理什么以及得到什么结果，但并没有规定才去何种行式以及如何实现。例如`Hotspot`是基于栈的执行引擎，`Dalvik`是基于寄存器的执行引擎。
    - 每个Java线程就是一个执行引擎的实例。
  - 内存区
    - 模拟实际计算机中的存储。
    - 方法区和Java堆是所有线程共享的。
    - 每个新的执行引擎实例被创建时会为这个执行引擎创建一个Java栈和一个PC寄存器。
  - 本地方法调用
    - 调用C或C++实现的本地方法的代码返回结果。

> 不管是何种指令集都只有几种基本的元素，如加、减、乘、除、取余等，这些运算又可以进一步分解为二进制位运算：与、或、异或等。这些指令又通过指令来完成，而指令的核心目的就是确定运算的种类和运算需要的数据，以及从哪里区操作数，将结果存放在哪里。相应的指令集会有对应的架构出现，如基于栈的或者基于寄存器的。
>

- 